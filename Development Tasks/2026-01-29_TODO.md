# OPS Bug Fixes - January 29, 2026

## BUGS

### Search
- [x] Search bar not working for employee (address search in project list & calendar)
  - **Fixed**: Added address field to search filter in `JobBoardProjectListView.swift`
- [x] Search doesn't include results in 'closed' or 'archived' folders
  - **Verified**: Working as designed - closed/archived projects appear in dedicated collapsible sections

### Sync/Data
- [x] Employee user's name not loaded after completing tutorial
  - **Fixed**: Updated `createCompany()` and `joinCompany()` in `OnboardingManager.swift` to update local User's firstName/lastName after PATCHing to Bubble
- [x] Remove from team API error (400 - missing `company` parameter)
  - **Fixed**: Added `companyId` parameter to `terminateEmployee()` in `APIService.swift` and updated call site in `ManageTeamView.swift`

### UI/Interaction
- [x] Tapping 'enter' on task notes in TaskFormSheet doesn't save
  - **Fixed**: Added keyboard toolbar with "Done" button to save notes in `TaskFormSheet.swift`
- [x] Too many dots in Home Screen header (`TEST CO • • trial •`)
  - **Fixed**: Removed duplicate bullet from `statusText()` in `AppHeader.swift`
- [x] Swipe down to dismiss project details still broken
  - **Fixed**: Added `.interactiveDismissDisabled(true)` to all ProjectDetailsView sheet presentations:
    - `UniversalJobBoardCard.swift` (3 locations)
    - `ContactDetailView.swift`
    - `ProjectActionBar.swift`
    - `JobBoardDashboard.swift`
    - `MonthGridView.swift`
    - `ScheduleView.swift`

### Onboarding UI
- [x] "30 Days Free" page: bullet point indentation
  - **Fixed**: Added `.frame(maxWidth: .infinity, alignment: .leading)` to benefit rows VStack in `BillingInfoView.swift`
- [x] "You're in" page: body indentation
  - **Fixed**: Added `alignment: .leading` to outer VStack in employeeView in `BillingInfoView.swift`

### Subscription
- [x] Next billing date field not populated
  - **Fixed**: Added fallback to use `company.subscriptionEnd` when `stripeInfo.currentPeriodEnd` is nil in `ManageSubscriptionView.swift`

---

## LOGIC FIXES
- [x] `hasCompletedAppOnboarding` should be set `true` after onboarding, before tutorial starts
  - **Fixed**: Moved `markOnboardingComplete()` call to execute when transitioning from .ready screen (before tutorial starts) in `OnboardingManager.swift`

---

## Completed This Session

### Summary
- **12 bugs fixed** (all bugs resolved!)
- **1 logic fix completed**
- **0 items pending**

### Files Modified
1. `JobBoardProjectListView.swift` - Added address to search filter
2. `APIService.swift` - Added companyId param to terminateEmployee
3. `ManageTeamView.swift` - Pass companyId to terminateEmployee
4. `AppHeader.swift` - Removed duplicate bullet from status text
5. `TaskFormSheet.swift` - Modified existing toolbar to save notes when notes field focused
6. `UniversalJobBoardCard.swift` - Added interactiveDismissDisabled (3 places)
7. `ContactDetailView.swift` - Added interactiveDismissDisabled
8. `ProjectActionBar.swift` - Added interactiveDismissDisabled
9. `JobBoardDashboard.swift` - Added interactiveDismissDisabled
10. `MonthGridView.swift` - Added interactiveDismissDisabled
11. `ScheduleView.swift` - Added interactiveDismissDisabled
12. `BillingInfoView.swift` - Fixed alignment in both creator and employee views
13. `ManageSubscriptionView.swift` - Added debug logging for billing date
14. `BubbleSubscriptionService.swift` - Improved timestamp parsing (NSNumber support)
15. `OnboardingManager.swift` - Mark onboarding complete before tutorial + update local user name fields
